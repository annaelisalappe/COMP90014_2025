
# Assignment 2

**Academic integrity**

This assignment should be completed by each student individually. <br>
Make sure you read this entire document, and ask for help if anything is not clear. <br>
Any changes or clarifications to this document will be announced via the LMS. <br>

Please make sure you review the University's rules on academic honesty and plagiarism: https://academichonesty.unimelb.edu.au/

Do not copy any code from other students. This is considered plagiarism.

Any ***small blocks*** of code (single line, small function) copied from the internet must be appropriately cited, including LLM output such as ChatGPT, Gemini, Claude etc. ***Large blocks*** of code (>10 lines) are not permitted. 

To cite code, include a comment above the section of code which was used. This comment should provide a URL link to the webpage, or the name of the LLM used. 

**Submission**

Your completed `A2.py` file will be turned in via LMS.

We use Turnitin for all assignments, which will compare your code to other students for similarity. It also compares your code against the web and estimates what proportion was generated by an LLM. 


-----------


### Prompt 

You work for the Peter Doherty Institute and are collaborating with the Royal Melbourne Hospital to identify novel anti-microbial resistance (AMR) genes encoded on plasmids.  These plasmids can be passed between different bacteria via horizontal gene transfer (HGT) and present a serious concern to human health. 

During the month of July in 2025 it was discovered that 3 patients at the hospital had bacterial infections which were resistant to the common antibiotics Amoxicillin, Doxycycline and Cephalexin. To understand more about the specific AMR genes present in these bacteria, a pure culture was obtained from each patient, followed by whole genome DNA sequencing. Surprisingly, no known AMR genes were identified. This implies that the AMR gene(s) are novel - ie have not been witness before. 

Your task is to identify the plasmid sequence containing AMR gene(s) so they can be studied further. 

To provide a negative control, 2 more patient samples were sequenced. These patients have a bacterial infection, but ***do not*** have resistance to the antibiotics above. The table below summarises the patients, organisms, and whether anti-microbial resistance was observed. 

| Patient ID | Organism ID | AMR? |
|---|---|---|
| 1 | organismA | **Yes** |
| 2 | organismB | **Yes** |
| 3 | organismC | **Yes** |
| 4 | organismD | *No* |
| 5 | organismE | *No* |


--------

### Program Specifications for this Assignment 

Write a python program which can identify and output the AMR plasmid sequence. 

This program does not need to be dynamic based on the input structure. In other words, only handle the situation where there are 5 organisms ABCDE; ABC have antibiotic resistance, and DE do not. 

Raw DNA sequencing reads are available for each organism as `.fasta` files. 



**Inputs**

The program should accept as input: 
- Path to directory containing one .fasta file per patient (`--indir`)
- Size of K to use, if using kmers in your program (`--kmer-size`)
- Minimum sequence length of plasmid to be considered (`--min-plasmid-size`)
- Path to output file where AMR plasmid sequence is written (`--outfile`)

>Assumptions you can make regarding the inputs:
>- Reads all have the same size. 
>- Reads have low error rate (~99.9% accuracy).
>- Reads are always in the forward orientation.
>- Read orientation is consistent between all `.fasta` files.
>- All reads are from the single bacterial organism cultured for that patient (no contamination). 
>- `--min-plasmid-size` will always be smaller than the actual AMR plasmid. 
>- `--kmer-size` will always be smaller than read length.

**Outputs**

The program should output: 
- A single .txt file containing the suspected AMR plasmid sequence. 

--------

### Test Suite

Do it yourself this time. 

There are 4 sets of test data available within the `data/` directory. Tests 1, 2, and 3 are small inputs, while test 4 is a medium size input for you to assess performance. Within each test directory, eg `data/test1`, you will find the ***actual*** AMR plasmid sequence in the `expected.txt` file. It is up to you to compare this with your program output to decide if your program is functioning as intended. 

A helper function - `rotate_sequence()` - has been provided within `A2.py` to help you compare output. The text within `expected.txt` has already been rotated to lexicographically smallest orientation. 


--------

### Completing the Assignment

1. Clone or pull updates from the [COMP90014 github repository](https://github.com/melbournebioinformatics/COMP90014_2025) to your computer. 
2. Copy the `A2` folder (`COMP90014_2025/assignments/A2`) and paste it somewhere else on your computer.
3. Open Visual Studio Code to your copy local of the `A2` folder.
4. Complete the `A2.py` file then upload to the LMS.

We advise you create a `venv` or `conda` (not recommended) virtual environment for the project.

**Unix Operating System**

If you have a windows PC (like me), ensure you have installed WSL and have connected to WSL when using visual studio code. 

Instructions for how to do this are available in the main README.md file of the [COMP90014 github repository](https://github.com/melbournebioinformatics/COMP90014_2025).

**Project Structure**

Your workspace should have the following structure before you begin. 

```
├── A2.py
├── README.md
└── data
    ├── test1
    │   ├── expected.txt
    │   ├── organismA.fasta
    │   ├── organismB.fasta
    │   ├── organismC.fasta
    │   ├── organismD.fasta
    │   └── organismE.fasta
    ├── test2
    │   ├── expected.txt
    │   ├── organismA.fasta
    │   ├── organismB.fasta
    │   ├── organismC.fasta
    │   ├── organismD.fasta
    │   └── organismE.fasta
    ├── test3
    │   ├── expected.txt
    │   ├── organismA.fasta
    │   ├── organismB.fasta
    │   ├── organismC.fasta
    │   ├── organismD.fasta
    │   └── organismE.fasta
    └── test4
        ├── expected.txt
        ├── organismA.fasta
        ├── organismB.fasta
        ├── organismC.fasta
        ├── organismD.fasta
        └── organismE.fasta
```

**Your Solution**

To complete the assignment, implement your solution in `A2.py`.

You will need to write functions which:
- Read input files.
- Implement small tasks which are run multiple times. 
- Generate helpful datastructures to speed up runtime / improve space efficiency. 

These should be called from the `main()` function. 

The logic to accept user input has been implemented for you (argparse). In addition, the logic to profile runtime and memory usage are already present. 

***Remember to save your work early and often.***

-----------

### Marking

Assignment 2 is harder than assignment 1. Grades may be adjusted based on cohort performance. 

**Grading Test files**

The input files we use to validate your code are similar to those in the `data` folder. 
They are not identical, so it's up to you to decide whether your code is correct.

**General marking guide**

- Correctness (60%)
    - Whether the correct AMR plasmid sequence is identified. 
    - Small differences, for example a few missing bases, will only incur a small mark deduction. 
- Runtime efficiency (15%)
    - How your solution scales with number of reads and read length. 
- Space efficiency (15%)
    - As above 
- Code structure / readability (10%)
    - A2.py has useful comments within each function.
    - Functions are not more than 40 lines long, not including comments (5-10 is a good length).
    - Functions are not heavily nested (due to conditional statements / loops). Maximum 3 levels within a function. 

FYI this is a function with 3 levels of nesting. Don't exceed this.
```
def my_func(seqs: list[str]):
    for i in range(len(seq)-1):
        for j in range(i, len(seq)):
            if i == j:
                continue 
    return 
```

Hint:<br>
4C2C20646F20796F75206B6E6F7720476F6473206F66204465617468206C6F7665206170706C6573